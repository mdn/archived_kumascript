
<pre class="script">
/* get the page language */

var lang = string.tolower(uri.parts(page.uri).path[0]);
/* fall back to page.language on a user page */
if (string.StartsWith(lang, "user:"))
  lang = page.language;
else if (string.contains(lang, ":"))
  lang = string.substr(lang, string.indexOf(lang, ":") + 1);

var bug = "bug ";

switch(lang){
  case 'ca':
    bug = "errada ";
    break;
  case 'cs':
    bug = "chyba ";
    break;
  case 'pl':
    bug = "błąd ";
    break;
}

var bugPageURL = 'https://bugzilla.mozilla.org/show_bug.cgi?id=' + $0;
var bugPageXML = web.xml(bugPageURL);
<p>#bugPageXML</p>;
<p>xml.text(bugPageXML, '//title')</p>;

var s = "";
if (!bugPageXML)
  s = "Couldn't access bug's page. Try reloading this page to see bug's status and summary in this tooltip.";
  <p>"!bugPageXML"</p>;
else{
  s = xml.text(bugPageXML, '//span[@id="static_bug_status"]');
  if (s){
    /* Remove \n and redundant spaces */
    s = string.replace(s, "\n", "");
    var s2 = "";
    var s3 = "";
    foreach(var i in num.series(0, #s - 1)){
      if ((s[i] == " ") && (s3 == " ")){
        continue;
      }
      else{
        s2 += s[i];
        s3 = s[i];
      }
    }
    s = s2 + '- ' + xml.text(bugPageXML, '//span[@id="short_desc_nonedit_display"]');
  }
  else if (xml.text(bugPageXML, '//title') == "Access Denied")
    s = "The access to the bug's page is restricted.";
  else
    s = "";
}

web.html('<a rel="external" href=' + bugPageURL + ' class="external" title="' + s + '">' + bug + $0 + '</a>');

%>
